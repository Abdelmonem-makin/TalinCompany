<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>المبيعات والفواتير - تالين</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link href="assets/css/style.css" rel="stylesheet">
</head>
<body class="bg-light">
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary"><div class="container-fluid"><a class="navbar-brand" href="index.html">تالين</a></div></nav>
  <main class="container py-4">
    <div class="d-flex justify-content-between mb-3">
      <h1 class="h4">المبيعات والفواتير</h1>
      <div>
        <a class="btn btn-outline-secondary" href="#" data-bs-toggle="modal" data-bs-target="#quoteModal">إنشاء عرض سعر</a>
        <a class="btn btn-primary ms-2" href="#" data-bs-toggle="modal" data-bs-target="#invoiceModal">إصدار فاتورة بيع</a>
      </div>
    </div>
    <div class="card p-3">
      <p>واجهة لإدارة الفواتير، الخصومات، ومتابعة التحصيل.</p>
      <div class="row g-2">
        <div class="col-md-4"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#discountModal">إدارة الخصومات</button></div>
        <div class="col-md-4"><button class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#receivablesModal">متابعة التحصيل</button></div>
      </div>
    </div>
  </main>
  <!-- Quote Modal -->
  <div class="modal fade" id="quoteModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">إنشاء عرض سعر</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <form id="quoteForm">
            <div class="mb-2"><label class="form-label">العميل</label><input class="form-control" name="client"></div>
            <div class="mb-2"><label class="form-label">العناصر (JSON مثال)</label><textarea class="form-control" name="items" placeholder='[{"sku":"SKU1","qty":10,"price":100}]'></textarea></div>
          </form>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button><button id="saveQuoteBtn" class="btn btn-primary">حفظ</button></div>
      </div>
    </div>
  </div>

  <!-- Invoice Modal -->
  <div class="modal fade" id="invoiceModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">إصدار فاتورة بيع</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <form id="invoiceForm">
            <div class="mb-2"><label class="form-label">العميل</label><input class="form-control" name="client"></div>
            <div class="mb-2"><label class="form-label">العناصر (JSON مثال)</label><textarea class="form-control" name="items" placeholder='[{"sku":"SKU1","qty":100,"price":80}]'></textarea></div>
            <div class="mb-2"><label class="form-label">الخصم (نسبة)</label><input class="form-control" name="discount" type="number" value="0"></div>
          </form>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button><button id="saveInvoiceBtn" class="btn btn-success">إصدار</button></div>
      </div>
    </div>
  </div>

  <!-- Discount Modal -->
  <div class="modal fade" id="discountModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">إدارة الخصومات</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <form id="discountForm">
            <div class="mb-2"><label class="form-label">نوع الخصم</label><select class="form-select" name="type"><option>على الفاتورة</option><option>حسب العميل</option><option>حسب المنتج</option></select></div>
            <div class="mb-2"><label class="form-label">قيمة الخصم (%)</label><input class="form-control" name="value" type="number"></div>
          </form>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">إغلاق</button><button id="saveDiscountBtn" class="btn btn-primary">حفظ</button></div>
      </div>
    </div>
  </div>

  <!-- Receivables Modal -->
  <div class="modal fade" id="receivablesModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">متابعة التحصيل</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body"><p>قائمة الفواتير والذمم (تجريبي).</p></div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">إغلاق</button></div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function safeLogForm(id, message){
      const form = document.getElementById(id);
      console.log(message, Object.fromEntries(new FormData(form)));
      const modalId = id.replace('Form','Modal');
      const modalEl = document.getElementById(modalId);
      if (modalEl) {
        const instance = bootstrap.Modal.getInstance(modalEl);
        if (instance) instance.hide();
      }
      alert(message+' (تجريبي)');
    }
    document.getElementById('saveQuoteBtn').addEventListener('click', ()=> safeLogForm('quoteForm','حفظ عرض السعر'));
    document.getElementById('saveInvoiceBtn').addEventListener('click', ()=> safeLogForm('invoiceForm','إصدار الفاتورة'));
    document.getElementById('saveDiscountBtn').addEventListener('click', ()=> safeLogForm('discountForm','حفظ إعدادات الخصم'));
  </script>
</body>
</html>
